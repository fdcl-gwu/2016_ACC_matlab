% This script will orthogonalize a direction cosine matrix
function [orthoDCM] = orthodcm(DCM)

%#eml

delT = DCM*DCM'-eye(3);
orthoDCM = DCM*(eye(3)-(1/2)*delT+(1/2)*(3/4)*delT.^2-(1/2)*(3/4)*(5/6)*delT.^3+(1/2)*(3/4)*(5/6)*(7/8)*delT.^4-(1/2)*(3/4)*(5/6)*(7/8)*(9/10)*delT.^5+...
    (1/2)*(3/4)*(5/6)*(7/8)*(9/10)*(11/12)*delT.^6-(1/2)*(3/4)*(5/6)*(7/8)*(9/10)*(11/12)*(13/14)*delT.^7+(1/2)*(3/4)*(5/6)*(7/8)*(9/10)*(11/12)*(13/14)*(15/16)*delT.^8-...
(1/2)*(3/4)*(5/6)*(7/8)*(9/10)*(11/12)*(13/14)*(15/16)*(17/18)*delT.^9+(1/2)*(3/4)*(5/6)*(7/8)*(9/10)*(11/12)*(13/14)*(15/16)*(17/18)*(19/20)*delT^10);
